---
layout: post
permalink: /2009/08/what-is-pubsubhubbub.html
title: "PubSubHubbubとは"
date: 2009-08-19T14:33:35.00+09:00
tags:
  - "yamaoka"
---
<p>yamaokaです。</p><br />
<br />
<p><br />
Twitterのみならず、FriendFeedやFacebookなど<br />
よりリアルタイムに近い更新がwebで求められるようになってきています。<br />
従来、更新情報の配信はRSSなどのフィードやAPIを通して行われてきました。<br />
しかしその場合、配信している側のサーバーに<br />
定期的にリクエストを投げないと更新があったかどうかわかりません。<br />
サーバーへのアクセスが多くなった場合、結構な負荷になります。<br />
さらにお行儀の悪いクライアントが存在すると、頻繁なアクセスを繰り返し、<br />
あたかもDoS攻撃のような状況が起こることもありえます。<br />
</p><br />
<br />
<p><br />
そこで考えられたオープンなHTTPベースのプロトコルが<a href="http://code.google.com/p/pubsubhubbub/">PubSubHubbub</a>です。<br />
<a href="http://googlereader.blogspot.com/2009/08/pubsubhubbub-support-for-reader-shared.html">Google ReaderとFriendFeedが対応</a>している他、<br />
国内のサービスでは<a href="http://corp.livedoor.com/pressrelease/2009/08/0818-01.html">livedoor Blogとliverdoor Readerがそれぞれ対応</a>しています。<br />
</p><br />
<br />
<p><br />
ではPubSubHubbubはどのような仕組みになっているのでしょうか。<br />
実際の仕組みについて、プロジェクトサイトに用意されているスライドが非常にわかりやすいので貼っておきます。<br />
</p><br />
<br />
<iframe src="http://docs.google.com/present/embed?id=ajd8t6gk4mh2_34dvbpchfs&size=m" frameborder="0" width="555" height="451"></iframe><br />
<br />
<p><br />
PubSubHubbubのプロトコルを構成するのはPublisher、Subscriber、Hubの3者です。<br />
Publisherはコンテンツを配信するサーバーに、<br />
Subscriberは更新情報を受け取るクライアント（フィードリーダーなど）に相当します。<br />
そして新しく登場したのがHubです。このHubは一体何をしてくれるのでしょうか。<br />
</p><br />
<br />
<p><br />
コンテンツ配信の仕組みはこうです。<br />
</p><br />
<br />
<ol><br />
<li>コンテンツの更新があった場合、PublisherはHubに更新をPOSTで通知する</li><br />
<li>Hubは新しいコンテンツをGETで取得、更新が実際に存在することを確認する</li><br />
<li>Hubは取得した更新情報をSubscriberのコールバックURLにPOSTで通知する</li><br />
</ol><br />
<br />
<p><br />
Subscriberに更新情報がプッシュの形で届くのがポイントですね。<br />
データのやりとりはAtomのフォーマットで行われます。<br />
この方式のメリットとしては次のようなものがあります。<br />
</p><br />
<br />
<ul><br />
<li>Subscriberの利用者がよりリアルタイムに近い更新情報を得られること</li><br />
<li>PublisherはHubだけに更新情報を通知すればよく、複数のSubscriberからアクセスが殺到する事態にはならないので負荷が軽減されること</li><br />
<li>Subscriberが増加するなどして負荷が上がる場合、Hubを増やせばスケールすることが容易でありPublisherには影響が及ばないこと</li><br />
</ul><br />
<br />
<p><br />
さらに、PubSubHubbubではSubscriberがHubに取得したい更新情報を登録する場合、<br />
本当にその登録が正しいか検証する仕組みも導入されています。<br />
具体的にはHubはSubscriberのコールバックURLにGETでアクセス、正しい要求か検証を行います。<br />
これによって、検証されていない大量のリクエスト（DoSのような）を防ぐ仕組みです。<br />
また、Subscriberにとっては自分が選んだ更新情報だけを受け取れるので、<br />
意図しないスパムのような被害を抑えることも可能です。<br />
</p><br />
<br />
<p><br />
システムの安全性とスケールの容易性が考慮されており、<br />
利用者はリアルタイム性というメリットを享受できる仕組みとして<br />
PubSubHubbubは優れているのではないでしょうか。<br />
実はこのPubSubHubbubプロトコル、Googleの20%ルールから産まれたプロジェクトだそうです。面白いですね。<br />
webのリアルタイム性が訴求されている現状、<br />
このような仕組みを作る取り組みはますます重要になっていくと思います。<br />
</p><br />
<br />
<p><br />
最後に。PubSubHubbubという単語ですが、<br />
Publisherの「Pub」とSubscriberの「Sub」、そしてHubを組み合わせた造語だと思われます。<br />
さらに「hubbub」という喧騒を表す単語を組み合わせて語呂をよくした感じでしょうか。<br />
発音は「パブサブハバブ」でいいのだと思います......多分。<br />
</p><br />
